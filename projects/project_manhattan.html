<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Mario Rodríguez Portfolio - Work Single</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="../assets/img/favicon.png" rel="icon">
  <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=https://fonts.googleapis.com/css?family=Inconsolata:400,500,600,700|Raleway:400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="../assets/css/style.css" rel="stylesheet">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HSK7JMST2Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-HSK7JMST2Q');
  </script>
  
  <!-- =======================================================
  * Template Name: MyPortfolio - v4.10.0
  * Template URL: https://bootstrapmade.com/myportfolio-bootstrap-portfolio-website-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Navbar ======= -->
  <div class="collapse navbar-collapse custom-navmenu" id="main-navbar">
    <div class="container py-2 py-md-5">
      <div class="row align-items-start">
        <div class="col-md-2">
          <ul class="custom-menu">
            <li class="active"><a href="../index.html">Home</a></li>
            <li><a href="../about.html">About Me</a></li>
            <li><a href="../contact.html">Contact</a></li>
          </ul>
        </div>
        <div class="col-md-6 d-none d-md-block  mr-auto">
          <div>
            <!-- <div>
            <a href="https://twitter.com/mariorod_dev"><span class="bi bi-twitter text-white mt-2 mr-3"> </span> @mariorod_dev</a>
            </div> -->
            <div>
              <a href="https://www.linkedin.com/in/mario-rodriguez-chaves"><span class="bi bi-linkedin text-white mt-2 mr-3"></span> Mario Rodríguez Chaves</a>
            </div>
            <div>
              <a href="./assets/Rodriguez_Mario.pdf" target="_blank">Download my CV</a>
            </div>
          </div>
        </div>
        <!-- <div class="col-md-4 d-none d-md-block">
          <h3>Hire Me</h3>
          <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam necessitatibus incidunt ut officiisexplicabo inventore. <br> <a href="#">mario.rod.dev@gmail.com</a></p>
        </div> -->
      </div>

    </div>
  </div>

  <nav class="navbar navbar-light custom-navbar">
    <div class="container">
      <a class="navbar-brand" href="../index.html">MyPortfolio.</a>
      <a href="#" class="burger" data-bs-toggle="collapse" data-bs-target="#main-navbar">
        <span></span>
      </a>
    </div>
  </nav>

  <main id="main">

    <section class="section">
      <div class="container">
        <div class="row mb-4 align-items-center">
          <div class="col-md-6" data-aos="fade-up">
            <h2>Procedural city in OpenGL</h2>
            <p class="mb-4"><span class="text-muted">Graphics, C++, OpenGL</span></p>
            <p>A city generated procedurally in a custom graphics engine.
              Project created in C++ using OpenGL.</p>
          </div>
        </div>
      </div>

      <div class="site-section pb-0">
        <div class="container">
          <div class="row align-items-stretch">
            <div class="col-md-7" data-aos="fade-up">
              <iframe width="560" height="300"
              src="https://www.youtube.com/embed/8bAvbA1r16U">
              </iframe>
            </div>
            <div class="col-md-5 ml-auto" data-aos="fade-up" data-aos-delay="100">
              <div class="sticky-content">
                <div class="mb-5">
                  <p>This project consists of the procedural generation and 
                    rendering of a cityusing the EDK3, an educational engine 
                    developed by ESAT University. Along with my colleage 
                    <a href="https://www.linkedin.com/in/carmen-martin-moreno">Carmen Martín Moreno</a>,
                    we developed the graphic core of the engine using OpenGL and GLSL.
                  </p>
                </div>

                <h4 class="h4 mb-3">What I did</h4>
                <ul class="list-unstyled list-line mb-5">
                  <li>The lighting system and all shaders related to lighting.</li>
                  <li>Postprocessing effects and use of framebuffers.</li>
                  <li>Fog effect.</li>
                  <li>Billboard of the light halos using the geometry shader.</li>
                  <li>Implementation of classes to abstract the user from the OpenGL core such as Texture, Buffer, Shader, Material, etc.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="row mb-4 align-items-center">
            <div class="col-md-8">
              <h2>Features</h2>
              <ul class="list-unstyled list-line mb-5">
              <li>Procedural generation of a city with buildings and streets.</li>
              <li>Fog and postprocessing effects such as bloom, blur, chromatic aberration.</li>
              <li>Creation and modification of pointlights, spotlights and directional light.</li>
              <li>Lighting system using forward rendering and the Phong model.</li>
              <li>Normal mapping.</li>
              <li>Camera culling.</li>
              <li>Generation of billboards and butterflies with geometry shader.</li>
              <li>First person camera to navigate the environment.</li>
              <li>Interface using ImGui to show stats, the hierarchy tree, manage and create lights, activate postprocessing, etc.</li>
              </ul>

              <h2>How I did it</h2>
              <h4>Lighting system</h4>
              <p>I designed the lighting system as a manager object that would manage all the lights of the scene.
                I created three light classes (directional light, spot light and point light) that can be placed in the scene and added to the scene hierarchy. These classes can only be instantiated by the LightManager to ensure that every light is tracked by the manager.
                <br><br>
                When rendering, the lights are passed to the LitMaterial object and their information is uploaded to the GPU when using that material. The camera position is also uploaded to calculate the specular reflection.
                <br><br>
                The LitMaterial uses a fragment shader that implements the Phong lightning model. Each light type
                is calculated separatedly and then added together. The calculation of the value of each light is done taking into account the ambient, diffuse and specular colors of the light as well as the diffuse and specular textures of the material.
                <br><br>
                Due to the Phong model limitations, the max amount of lights in the scene are limited. As the cost of adding new lights escalates quickly.
                </p>

                <h4>Light halos using the geometry shader</h4>

                <div class="row align-items-stretch">
                  <div class="col-md-9" >
                    <p>When designing and implementing the lights, I wanted them to have the typical halo that
                      you see in videogames (and in real life). To do so, I had to have a quad in the same position
                      of the light with the texture of a halo. This quad had to be rotated each frame so that its forward vector was the opposite of the camera's forward vector. 
                      <br><br>
                      I could not figure out how to do this on the CPU, as it generated many problems due to the architecture of the engine we were working on. As an alternative, I researched how geometry shaders worked (as I had a vague idea of what they did) and decided to try this way.
                      <br><br>
                      The final solution that I implemented was that each light had a HaloMaterial with a specific vertex, geometry and fragment shader. For each light, I uploaded their position as a single vertex to the vertex shader. Then, in the geometry shader, I used that point and the forward vector of the camera (passed as a uniform) to generate a quad that faced the camera. Finally, in the fragment shader I setted the halo texture to the quad.
                    </p>
                  </div>
                  <div class="col-md-3 ml-auto">
                    <img src="../assets/img/manhattan_halo.gif" width="400" height="250">
                  </div>
                </div>

                <h4>Fog effect</h4>
                <div class="row align-items-stretch">
                  <div class="col-md-9">
                    <p>I implemented the fog effect as an attribute of the LightingManager and can be parametrized through the manager. The fog is calculated using the exponential formula for the fog. The final color of the lit fragment shader is a mix between the color of the fog and the calculated color of the fragment.
                    </p>
                  </div>
                  <div class="col-md-3 ml-auto">
                    <img src="../assets/img/manhattan_fog.gif" width="400" height="250">
                  </div>
                </div>


                <h4>Postprocessing effects</h4>
                <p>I implemented all the postprocessing effects of the Engine, which are:
                  <ul>
                    <li>Blur with a 5x5 gaussian kernel.</li>
                    <li>Vignette.</li>
                    <li>Chromatic Aberration.</li>
                    <li>Bloom.</li>
                  </ul>

                  To create the postprocessing effects I used the frame buffer object of OpenGL, so the first thing I created was a class FrameBuffer that served as an abstraction to the OpenGL object.
                  This class would store the fbo id and perform all the actions related to the OpenGL object.
                  <br>
                  <br>
                  To create all the effects, I painted the scene into a FrameBuffer that contained an OpenGL RenderBuffer object and that had attached two textures to paint the frame on. One for the color of the scene and one for the depth of the scene.
                  <br>
                  <br>
                  Then I rendered a quad that occupies the whole screen and used the color texture to render the whole scene into the quad. During this pass, I applied the blur, vignette and chromatic aberration effects.
                  <br>
                  <br>
                  To apply the bloom effect, I used two textures to paint the image from one texture to the other several times, each time applying the bloom effect. The steps required to achieve this effect where:
                  <ol>
                    <li>Bind the frame buffer with last texture used.</li>
                    <li>Render the quad object applying the bloom shader, that performs a bloom pass, and store the render in an empty texture.</li>
                    <li>Repeat steps 1-3 10 times.</li>
                    <li>Render the final texture to show the final scene.</li>
                  </ol>
                 </p>
            </div>
          </div>
        </div>
    </section>
  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer class="footer" role="contentinfo">
    <div class="container">
      <div class="row">
        <div class="col-sm-6">
          <p class="mb-1">&copy; Copyright Mario Rodríguez Chaves. All Rights Reserved</p>
          <div class="credits">
            <!--
            All the links in the footer should remain intact.
            You can delete the links only if you purchased the pro version.
            Licensing information: https://bootstrapmade.com/license/
            Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=MyPortfolio
          -->
            Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
          </div>
        </div>
        <div class="col-sm-6 social text-md-end">
          <a href="https://twitter.com/mariorod_dev"><span class="bi bi-twitter"></span></a>
          <!--a href="#"><span class="bi bi-facebook"></span></a-->
          <!--a href="#"><span class="bi bi-instagram"></span></a-->
          <a href="https://www.linkedin.com/in/mario-rodriguez-chaves"><span class="bi bi-linkedin"></span></a>
        </div>
      </div>
    </div>
  </footer>

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="../assets/vendor/aos/aos.js"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="../assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="../assets/js/main.js"></script>

</body>

</html>